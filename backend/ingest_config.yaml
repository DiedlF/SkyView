# Skyview Ingest Configuration
# Controls which variables are downloaded and how grids are handled.

region:
  icon-d2: full          # Use native grid (no crop) — 746×1215
  icon-eu: full          # Use full ICON-EU coverage (no crop)

# D2 full domain bounds (used for EU cropping)
d2_bounds:
  lat_min: 43.18
  lat_max: 58.08
  lon_min: -3.94
  lon_max: 20.34

retention:
  keep_runs: 1           # Latest run only

# Default profile per model when ingest.py is run with --profile auto/default.
default_profiles:
  icon-d2: skyview_d2_core
  icon-eu: skyview_eu_core

# Ingest profiles
# - full: legacy superset (kept for diagnostics/back-compat)
# - skyview_d2_core: D2 coverage incl. skew-t/meteogram support
# - skyview_eu_core: EU coverage for symbols + wind + overlays only
profiles:
  full:
    include_groups:
      - aviation
      - surface_weather
      - severe_weather
      - soaring

  skyview_d2_core:
    variables:
      # Symbols + overlays
      - ww
      - cape_ml
      - htop_dc
      - hbas_sc
      - htop_sc
      - lpi_max
      - ceiling
      - clcl
      - clcm
      - clch
      - clct
      - clct_mod
      - mh
      - t_2m
      - td_2m
      - relhum_2m
      - ashfl_s
      # Wind + gusts
      - u_10m
      - v_10m
      - vmax_10m
      # Precip overlays
      - tot_prec
      - rain_gsp
      - rain_con
      - snow_gsp
      - snow_con
      - grau_gsp
      - h_snow
      # Additional context
      - hzerocl
    pressure_levels:
      # D2 supports emagram + meteogram + selectable overlays
      variables: [u, v, t, fi, relhum]
      levels: [1000, 975, 950, 850, 700, 600, 500, 400, 300, 200]

  skyview_eu_core:
    variables:
      # Symbols + overlays (no skew-t/meteogram-only context)
      - ww
      - cape_ml
      - htop_dc
      - hbas_sc
      - htop_sc
      - lpi_max
      - ceiling
      - clcl
      - clcm
      - clch
      - clct
      - clct_mod
      - mh
      - t_2m
      - td_2m
      - relhum_2m
      - ashfl_s
      # Wind + gusts
      - u_10m
      - v_10m
      - vmax_10m
      # Precip overlays
      - tot_prec
      - rain_gsp
      - rain_con
      - snow_gsp
      - snow_con
      - grau_gsp
      - h_snow
      # Optional aviation overlay context
      - hzerocl
    pressure_levels:
      # Reduced EU pressure coverage to selectable overlay/wind levels only.
      # No emagram/meteogram levels on EU.
      variables: [u, v, t]
      levels: [950, 850, 700, 500, 300]

groups:
  aviation:
    enabled: true
    variables:
      - ww
      - cape_ml
      - cin_ml
      - htop_dc
      - hbas_sc
      - htop_sc
      - lpi_max
      - ceiling
      - clcl
      - clcm
      - clch
      - clct
      - clct_mod
      - cldepth
      - hzerocl
      - mh

  surface_weather:
    enabled: true
    variables:
      - t_2m
      - td_2m
      - tmax_2m
      - tmin_2m
      - relhum_2m
      - pmsl
      - ps
      - u_10m
      - v_10m
      - vmax_10m
      - tot_prec
      - prr_gsp
      - prs_gsp
      - prg_gsp
      - rain_gsp
      - rain_con
      - snow_gsp
      - snow_con
      - grau_gsp
      - h_snow
      - freshsnw
      - t_g

  severe_weather:
    enabled: true
    variables:
      - dbz_cmax
      - dbz_ctmax
      - dbz_850
      - sdi_2
      - vorw_ctmax
      - w_ctmax
      - uh_max
      - uh_max_low
      - uh_max_med
      - echotop
      - tcond_max
      - tcond10_mx

  soaring:
    enabled: true
    variables: []

static_variables:
  - hsurf

pressure_levels:
  variables: [u, v, t, fi, relhum]
  levels: [1000, 975, 950, 850, 700, 600, 500, 400, 300, 200]

# Variables that may not exist in ICON-EU (will be skipped gracefully)
d2_only_variables:
  - cldepth
  - grau_gsp
  - dbz_cmax
  - dbz_ctmax
  - dbz_850
  - sdi_2
  - vorw_ctmax
  - w_ctmax
  - uh_max
  - uh_max_low
  - uh_max_med
  - echotop
  - tcond_max
  - tcond10_mx

d2_variable_map: {}

# ICON-EU variable name overrides (NPZ key → DWD filename variable)
eu_variable_map:
  hbas_sc: hbas_con
  htop_sc: htop_con
  lpi_max: lpi_con_max

# Variables not available in ICON-EU (will be filled with zeros)
eu_optional_variables:
  - prr_gsp
  - prs_gsp
  - prg_gsp
  - freshsnw
